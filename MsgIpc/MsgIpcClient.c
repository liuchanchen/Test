/******************************************************************************

版权所有 (C), 刘剑个人文件

******************************************************************************
文 件 名 : MsgIpcClient.c
版 本 号 : 初稿
作 者 : liujian
生成日期 : 2015/10/15
最近修改 :
功能描述 :
函数列表 :
修改历史 :
1.日 期 : 2015/10/15
作 者 : liujian
修改内容 : 创建文件

******************************************************************************/

/*----------------------------------------------*
* 包含头文件 *
*----------------------------------------------*/
#include "MsgIpcClient.h"
/*----------------------------------------------*
* 外部变量说明 *
*----------------------------------------------*/

/*----------------------------------------------*
* 外部函数原型说明 *
*----------------------------------------------*/

/*----------------------------------------------*
* 内部函数原型说明 *
*----------------------------------------------*/

/*----------------------------------------------*
* 全局变量 *
*----------------------------------------------*/

/*----------------------------------------------*
* 模块级变量 *
*----------------------------------------------*/

/*----------------------------------------------*
* 常量定义 *
*----------------------------------------------*/

/*----------------------------------------------*
* 宏定义 *
*----------------------------------------------*/
int main(int argc, char ** argv)
{
	key_t key = 20;//20是双方商定好的众所周知的key值
	int msgfd = -1;
	msgbufStruct stMsgBuf;
	int SendLen = 0;
	char * SendBuf= "abcdefg\0";

	memset(&stMsgBuf, 0x0, sizeof(stMsgBuf));
#if 0
	if ((msgfd = msgget(key, 0)) < 0)//打开队列
	{
		perror("msgget error:");
	}
#endif
	//fprintf(stdout, "", __VA_ARGS__)
	printf("argv:%s\n",argv[1]);
	msgfd = atoi(argv[1]);
	printf("msgfd:%d\n", msgfd);
	stMsgBuf.MsgType = 2;
	memcpy(stMsgBuf.MsgBuf, SendBuf, strlen(SendBuf));
	SendLen = strlen(stMsgBuf.MsgBuf);
	printf("SendLen:%d\n", SendLen);
	msgsnd(msgfd, &stMsgBuf, SendLen, 0);

	return 0;
}
